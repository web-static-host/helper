<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ–º–æ—â–Ω–∏–∫ —Ç–µ—Ö–Ω–∞—Ä—è</title>
    <link rel="icon" type="image/png" href="icon.png">
    
    <link rel="stylesheet" href="style.css">
    <script src="config.js"></script>
    <script src="script.js" defer></script>

</head>
<body>

<div class="main-wrapper">
    <div class="column col-left">
        <h2 style="display: flex; align-items: center;">
            –†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ –ò–ù–ù 
            <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ–± –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–ª–∏ –ò–ü –≤ –æ–¥–∏–Ω –∫–ª–∏–∫. –í–≤–µ–¥–∏—Ç–µ –ò–ù–ù –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞. –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Ç—è–Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ (–ø–æ–ª–Ω–æ–µ –∏ —Å–æ–∫—Ä–∞—â–µ–Ω–Ω–æ–µ), –ö–ü–ü, –û–ì–†–ù, –∞–¥—Ä–µ—Å, –§–ò–û —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—è –∏ –∫–æ–¥ –ò–§–ù–°.</span></span>
        </h2>
        <div class="search-box">
            <input type="text" id="innInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ò–ù–ù">
            <button class="primary-btn" onclick="getData()">–ù–∞–π—Ç–∏</button>
        </div>
        <div id="errorBox" style="color:red; margin-bottom:10px;"></div>
        
        <table class="result-table" id="resTable"><tbody id="resBody"></tbody></table>

        <div id="sfrResult" style="margin-top: 15px; min-height: 50px; font-size: 14px;"></div>

        <div id="rawContainer" style="display:none; margin-top:20px;">
            <details><summary style="cursor:pointer; color:#888; font-size:12px;">JSON –¥–∞–Ω–Ω—ã–µ</summary><pre id="rawData"></pre></details>
        </div>
    </div>

    <div class="column col-mid">
        <h2>–ü–æ–ª–µ–∑–Ω–æ–µ</h2>
        <details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å—Å—ã–ª–∫–∏</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∏–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥—Ä–µ—Å–æ–≤ —Å–∞–π—Ç–æ–≤ (–§–ù–°, –ê—Å—Ç—Ä–∞–ª –û—Ç—á–µ—Ç, –õ–ö –û–§–î).–ò–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –¥–ª–∏–Ω–Ω—ã—Ö URL-–∞–¥—Ä–µ—Å–æ–≤ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∫–ª–∏–µ–Ω—Ç–∞. –ö–Ω–æ–ø–∫–∞ üìã –∫–æ–ø–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.</span></span>
                </div>
            </summary>
            <div id="linksContainer" class="links-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </details>

        <details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ó–¥–µ—Å—å –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ pdf, –ª–∏–±–æ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–æ–≥–¥–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –º–µ–Ω–µ–¥–∂–µ—Ä—ã, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏—Ö –∫–ª–∏–µ–Ω—Ç–∞–º</span></span>
                </div>
            </summary>
            <div id="instructionsContainer" class="links-list">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </details>

        <details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –û–§–î</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –û–§–î –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ö–ö–¢.</span></span>
                </div>
            </summary>
            <div style="padding: 10px 0;">
                <div id="ofdLinksContainer" class="links-list" style="margin-bottom:10px;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                
                <div style="display: flex; align-items: center; justify-content: flex-start;">
                    <button onclick="toggleAstral()" style="padding:8px; cursor:pointer; flex-grow: 1;">–ò–ù–ù –∫–æ–º–ø–∞–Ω–∏–∏, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—â–µ–π –ö–ö–¢</button>
                    <span class="tooltip" style="margin-left: 8px;"><span class="tooltip-icon">?</span><span class="tooltiptext">–ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–ò–ù–ù –∏ Email —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤). –≠—Ç–æ –≤–∞–∂–Ω–æ –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Å—Å –ê—Ç–æ–ª –Ω–∞ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –¥—Ä–∞–π–≤–µ—Ä–æ–≤, –≥–¥–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–Ω–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏.</span></span>
                </div>

                <div id="astralBox" class="astral-box" style="display:none; margin-top: 10px;">
                    <p style="font-size:12px; margin:0 0 10px 0;">–ò–ù–ù: <b>4027145240</b> <button class="copy-btn" onclick="copyText('4027145240', this)">üìã</button></p>
                    <select id="staffSelect" style="width:100%;" onchange="showStaffEmail()">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞...</option>
                    </select>
                    <div id="staffEmailResult" style="margin-top:10px; font-size:13px;"></div>
                </div>
            </div>
        </details>
    </div>

    <div class="column col-right">
        <h2>–î–æ–ø –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>

	<details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–ò–§–ù–° –ø–æ –∞–¥—Ä–µ—Å—É</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ò—â–µ—Ç –∫–æ–¥ –∏—Ñ–Ω—Å –ø–æ –∞–¥—Ä–µ—Å—É. –ê–¥—Ä–µ—Å –º–æ–∂–Ω–æ –≤–≤–æ–¥–∏—Ç—å –≤ —Å–≤–æ–±–æ–¥–Ω–æ–π —Ñ–æ—Ä–º–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ö–∞–ª—É–≥–∞ –õ–µ–Ω–∏–Ω–∞ 1¬ª). –¢–∞–∫ –∂–µ –º–æ–∂–µ–Ω—Ç –ø–æ–º–æ—á—å —Å –ø–æ–∏—Å–∫–æ–º –∏–Ω–¥–µ–∫—Å–∞, –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –µ–≥–æ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª.</span></span>
                </div>
            </summary>
            <div style="padding-top:10px;">
                <input type="text" id="addressInput" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º..." 
                       style="width: 100%; margin-bottom: 8px; box-sizing: border-box; padding: 5px;">
                
                <button class="gen-btn" style="width: 100%;" onclick="getIfnsByAddress()">–ù–∞–π—Ç–∏ –∫–æ–¥</button>

                <div id="addressIfnsResult" style="margin-top: 10px; font-weight: bold; font-size: 13px;">
                    <span style="color: #888; font-weight: normal;">–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏ –Ω–∞–∂–º–∏—Ç–µ –ø–æ–∏—Å–∫</span>
                </div>
            </div>
        </details>


        <details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª–µ–π</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ò–Ω–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ—Å—è—Ç –ø—Ä–∏–¥—É–º–∞—Ç—å –∑–∞ –Ω–∏—Ö –ø–∞—Ä–æ–ª—å. –ï–≥–æ –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–¥–µ—Å—å –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫ –Ω–µ–º—É –Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª</span></span>
                </div>
            </summary>
            <div style="padding-top:10px;">
                <div class="gen-row">–î–ª–∏–Ω–∞: 
                    <select id="passLen">
                        <option value="8" selected>8</option>
                        <option value="12">12</option>
                    </select>
                </div>
                <div class="gen-row"><input type="checkbox" id="genLower" checked> abc</div>
                <div class="gen-row"><input type="checkbox" id="genUpper" checked> ABC</div>
                <div class="gen-row"><input type="checkbox" id="genNum" checked> 123</div>
                <button class="gen-btn" onclick="generatePass()">–°–æ–∑–¥–∞—Ç—å –ø–∞—Ä–æ–ª—å</button>
                <div id="passResult" onclick="copyPass()">****</div>
            </div>
        </details>

        <details class="tool-section">
            <summary>
                <div class="summary-content">
                    <span>–®–∞–±–ª–æ–Ω—ã –ø–∏—Å–µ–º –¥–ª—è –æ—Ç–≥—Ä—É–∑–∫–∏ 1–°</span>
                    <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –ø–∏—Å—å–º–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ Thunderbird.</span></span>
                </div>
            </summary>
            <div style="padding-top:10px;">
                <button class="gen-btn" style="width: 100%;" onclick="openMailModal()">üìß –°–æ–∑–¥–∞—Ç—å –ø–∏—Å—å–º–æ</button>
            </div>
        </details>
    </div>
</div>

<div id="mailModal" class="modal" style="display:none; position:fixed; z-index:999; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
    <div class="modal-content" style="background:#fff; margin:2% auto; padding:20px; width:480px; border-radius:8px; position:relative; box-shadow: 0 4px 15px rgba(0,0,0,0.3); max-height: 90vh; overflow-y: auto;">
        <div id="gatewayError" style="display:none; align-items:center; justify-content:center; gap:8px; background:#fff0f0; border:1px solid #ffcccc; padding:8px; border-radius:6px; margin-bottom:12px; color:#d93025; font-size:12px;">
        <span style="font-weight:bold;">‚ö†Ô∏è –®–ª—é–∑ –Ω–µ –∑–∞–ø—É—â–µ–Ω!</span>
        <a href="app/gateway.exe" style="color:#1a73e8; text-decoration:underline;">–°–∫–∞—á–∞—Ç—å —à–ª—é–∑ <span class="tooltip"><span class="tooltip-icon">?</span><span class="tooltiptext">–®–ª—é–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –≤ Thunderbird –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π. –ë–µ–∑ –Ω–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.</span></a>
    
         </div>
        
        <span onclick="closeMailModal()" style="position:absolute; right:15px; top:10px; cursor:pointer; font-size:24px;">&times;</span>
        <h3 style="margin-top:0;">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ—Ç–≥—Ä—É–∑–∫–∏</h3>
        
        <div style="margin-bottom:12px;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–¢–∏–ø –æ—Ç–≥—Ä—É–∑–∫–∏:</label>
            <select id="orderTypeSelect" style="width:100%; padding:6px;" onchange="applyTemplate()">
                <option value="local">–û—Ç–≥—Ä—É–∑–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π 1–°</option>
                <option value="dop">–û—Ç–≥—Ä—É–∑–∫–∞ –¥–æ–ø –ª–∏—Ü–µ–Ω–∑–∏–∏ 1–°</option>
                <option value="otrasl">–û—Ç–≥—Ä—É–∑–∫–∞ –ö–ü –æ—Ç—Ä–∞—Å–ª–µ–≤–æ–≥–æ</option>
            </select>
        </div>

        <div style="margin-bottom:12px;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–ö–æ–º—É (–ú–µ–Ω–µ–¥–∂–µ—Ä):</label>
            <div style="display:flex; gap:5px; position: relative;">
                <div style="flex-grow:1; position: relative;">
                    <input type="text" id="managerSearch" placeholder="üîç –ù–∞–π—Ç–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞..." 
                           style="width:100%; padding:6px; font-size:12px; border:1px solid #ccc; border-radius:4px; box-sizing:border-box;"
                           oninput="filterManagers()" 
                           onclick="showAllManagers()"
                           onfocus="showAllManagers()"
                           onkeydown="handleManagerKey(event)"
                           autocomplete="off">
                    <div id="managerDropdown" class="custom-dropdown" style="display:none;"></div>
                </div>
                <input type="text" id="mailTo" placeholder="Email" style="width:160px; padding:6px; font-size:12px;">
            </div>
        </div>

        <div style="margin-bottom:10px;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è:</label>
            <input type="text" id="mailOrg" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏" style="width:100%; padding:6px; box-sizing:border-box;">
        </div>

        <div style="margin-bottom:12px;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–∞–≤–∫–∏ 1–°:</label>
            <input type="text" id="mailDeliveryName" placeholder="–ù–∞–ø—Ä: 1–°:–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è 8. –ë–∞–∑–æ–≤–∞—è –≤–µ—Ä—Å–∏—è" style="width:100%; padding:6px; box-sizing:border-box;">
        </div>

        <div style="display: none;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä (HTML):</label>
            <textarea id="mailBody" rows="6" style="width:100%; padding:8px; box-sizing:border-box; font-size:11px; background:#f4f4f4; border: 1px solid #ddd;" readonly></textarea>
        </div>

        <div style="margin-bottom:15px; border-top: 1px solid #eee; padding-top: 10px;">
            <label style="font-size:11px; font-weight:bold; color: #555;">–í–ª–æ–∂–µ–Ω–∏—è:</label>
            <div id="defaultInstructionBox" style="background: #eef9ff; padding: 5px 10px; border-radius: 4px; border: 1px solid #cce5ff; font-size: 11px; margin-bottom: 8px; display: flex; align-items: center;">
                <span style="margin-right: 10px;">üìÑ</span> 
                <span id="instructionFileName">–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</span>
            </div>
            <div id="dropZone" style="border: 2px dashed #bbb; padding: 15px; text-align: center; border-radius: 6px; background: #fafafa; cursor: pointer;">
                <span id="dropZoneText" style="font-size: 11px; color: #777;">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ <b>ZIP</b> –∏ <b>PDF</b> —Å—é–¥–∞</span>
                <div id="fileList" style="margin-top: 8px; font-size: 11px; color: #28a745;"></div>
                <input type="file" id="fileLic" accept=".pdf,.zip" style="display:none;" multiple>
            </div>
        </div>
        
        <button class="primary-btn" style="width:100%; padding:12px; font-weight: bold;" onclick="sendMail()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ Thunderbird</button>
    </div>
</div>

</body>
</html>